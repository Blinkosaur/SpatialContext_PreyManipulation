<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>spatialcontext_code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SpatialContext_Code_files/libs/clipboard/clipboard.min.js"></script>
<script src="SpatialContext_Code_files/libs/quarto-html/quarto.js"></script>
<script src="SpatialContext_Code_files/libs/quarto-html/popper.min.js"></script>
<script src="SpatialContext_Code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SpatialContext_Code_files/libs/quarto-html/anchor.min.js"></script>
<link href="SpatialContext_Code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SpatialContext_Code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SpatialContext_Code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SpatialContext_Code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SpatialContext_Code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="the-influence-of-spatial-context-on-prey-manipulation-behaviors-in-the-california-moray-eel-gymnothorax-mordax" class="level1">
<h1>The influence of spatial context on prey manipulation behaviors in the California moray eel (<em>Gymnothorax mordax</em>)</h1>
<section id="research-aims" class="level2">
<h2 class="anchored" data-anchor-id="research-aims">Research Aims:</h2>
<p>Our aim was to assess the impact of spatial context on prey manipulation in the California moray eel (<em>Gymnothorax mordax</em>), a crevice forager with a diverse prey handling repertoire. We first compared the duration engaged in specific manipulation behaviors between spatially “enclosed” and “open” foraging environments (Experiment 1), followed by a comparison of tightly enclosed spaces that were scaled to individual moray diameter (Experiment 2).</p>
<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries">Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: splines
Loading required package: gamlss.data

Attaching package: 'gamlss.data'

The following object is masked from 'package:datasets':

    sleep

Loading required package: gamlss.dist
Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select

Loading required package: nlme

Attaching package: 'nlme'

The following object is masked from 'package:dplyr':

    collapse

Loading required package: parallel
 **********   GAMLSS Version 5.4-12  ********** 
For more on GAMLSS look at https://www.gamlss.com/
Type gamlssNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'rstatix'

The following object is masked from 'package:MASS':

    select

The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix

Attaching package: 'Matrix'

The following objects are masked from 'package:tidyr':

    expand, pack, unpack


Attaching package: 'lme4'

The following object is masked from 'package:gamlss':

    refit

The following object is masked from 'package:nlme':

    lmList</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsignif)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'glmmTMB'

The following object is masked from 'package:gamlss':

    refit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"emmeans"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'cowplot'

The following object is masked from 'package:ggpubr':

    get_legend

The following object is masked from 'package:lubridate':

    stamp</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'patchwork'

The following object is masked from 'package:cowplot':

    align_plots

The following object is masked from 'package:MASS':

    area</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magick)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to ImageMagick 6.9.12.93
Enabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp
Disabled features: fftw, ghostscript, x11</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="experiment-1-open-vs-enclosed-crevices" class="level1">
<h1>EXPERIMENT 1: Open vs Enclosed Crevices</h1>
<p>In experiment 1, our objective was to determine whether morays exhibit similar prey manipulation behaviors between open and enclosed foraging environments. We created three experimental feeding treatments; two enclosed (5cm and 10cm in diameter) and one open treatment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming &amp; reading all the datasets </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Phase1-SpatialContext.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'bit':
  method   from  
  print.ri gamlss</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 115 Columns: 21
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (4): Trial info, Treatment, Eel, Knotting_Binomial
dbl (17): Trial_Duration, Handling_Dur, Bites, Ptransport_Dur, Ptransport_Pr...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  `Trial info` Treatment Eel    Trial_Duration Handling_Dur Bites Ptransport_Dur
  &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
1 R1 - T1      Open      Bill             19.8        0.855     8           8.84
2 R1 - T1      Open      Johnny           27.1        3.01     12          18.5 
3 R1 - T1      Open      Snick…           77.7       12.3      36          60.6 
4 R1 - T2      Open      Horat…           10.6        0.685     5           5.08
5 R1 - T2      Open      Spagh…           83.2        5.76     24          39   
6 R1 - T2      Open      Eelvis           88         44.5      13           2.8 
# ℹ 14 more variables: Ptransport_Prop &lt;dbl&gt;, Shaking_Dur &lt;dbl&gt;,
#   Shaking_Prop &lt;dbl&gt;, Shaking_Prop_Handling &lt;dbl&gt;, Knotting_Dur &lt;dbl&gt;,
#   Knotting_Prop &lt;dbl&gt;, Knotting_Prop_Handling &lt;dbl&gt;, Knotting_Binomial &lt;chr&gt;,
#   Rotating_Dur &lt;dbl&gt;, Rotating_Prop &lt;dbl&gt;, Rotating_Prop_Handling &lt;dbl&gt;,
#   Ramming_Dur &lt;dbl&gt;, Ramming_Prop &lt;dbl&gt;, Ramming_Prop_Handling &lt;dbl&gt;</code></pre>
</div>
</div>
<p>P1 data contains: Treatment = ‘Open’ (open spatial treatment), ‘10cm’ (10cm diameter enclosed treatment), ‘5cm’ (5cm diameter enclosed treatment) Eel = name of the individual Trial_Duration = Duration of time in seconds from first bite to completion of swallowing Handling_Dur = Time in seconds spent engaged in at least one of the prey manipulation behaviors Bites = total individual bites Ptransport_Dur = The duration of time in seconds engaged in swallowing (pharyngeal transport)</p>
<p>All behaviors (shaking, ramming, rotating, and knotting) have three columns: Example - Shaking_Dur = the total duration spent shaking Shaking_Prop = Proportion of time spent shaking out of the total Trial_Duration Shaking_Prop_Handling = Proportion of time spent shaking out of the total Handling_Dur</p>
<p>Knotting_Binomial = was knotting observed, yes/no</p>
<section id="trial-component-durations" class="level2">
<h2 class="anchored" data-anchor-id="trial-component-durations">⌛⌛⌛️ TRIAL COMPONENT DURATIONS ⌛⌛⌛️</h2>
<p>This section of code focuses on the total feeding time (Trial_Duration), the time spent handling prey (Handling_Dur), and the time spent swallowing prey (Ptransport_Dur) between treatments (open vs 5cm vs 10cm treatments)</p>
<section id="data-prep---duration-of-trial-components-feeding-duration-manipulation-duration-swallowing-duration" class="level3">
<h3 class="anchored" data-anchor-id="data-prep---duration-of-trial-components-feeding-duration-manipulation-duration-swallowing-duration">Data Prep - Duration of Trial Components [Feeding Duration, Manipulation Duration, Swallowing Duration]</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting the columns we want:</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>DurSelP1 <span class="ot">&lt;-</span> P1 <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, Eel, Trial_Duration, Ptransport_Dur, Handling_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DurSelP1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Treatment Eel        Trial_Duration Ptransport_Dur Handling_Dur
  &lt;chr&gt;     &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;
1 Open      Bill                 19.8           8.84        0.855
2 Open      Johnny               27.1          18.5         3.01 
3 Open      Snickers             77.7          60.6        12.3  
4 Open      Horatio              10.6           5.08        0.685
5 Open      Spaghettio           83.2          39           5.76 
6 Open      Eelvis               88             2.8        44.5  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making treatment a factor:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>DurSelP1<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(DurSelP1<span class="sc">$</span>Treatment)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Prepping a dataframe for Graphics - Pivot for long format </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>P1_Dur_Long <span class="ot">&lt;-</span> DurSelP1 <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Trial_Duration, Ptransport_Dur, Handling_Dur), </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Duration"</span>, </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Time"</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Making Duration a factor:</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>P1_Dur_Long<span class="sc">$</span>Duration <span class="ot">=</span> <span class="fu">factor</span>(P1_Dur_Long<span class="sc">$</span>Duration)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P1_Dur_Long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Treatment Eel    Duration         Time
  &lt;fct&gt;     &lt;chr&gt;  &lt;fct&gt;           &lt;dbl&gt;
1 Open      Bill   Trial_Duration 19.8  
2 Open      Bill   Ptransport_Dur  8.84 
3 Open      Bill   Handling_Dur    0.855
4 Open      Johnny Trial_Duration 27.1  
5 Open      Johnny Ptransport_Dur 18.5  
6 Open      Johnny Handling_Dur    3.01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Mean &amp; SE For Graphics - This code is used to create future bar graphs comparing the mean time spent engaged in feeding, prey handling, and swallowing between treatments</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>P1_Dur_SE <span class="ot">=</span> P1_Dur_Long <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Duration, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Duration'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P1_Dur_Long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Treatment Eel    Duration         Time
  &lt;fct&gt;     &lt;chr&gt;  &lt;fct&gt;           &lt;dbl&gt;
1 Open      Bill   Trial_Duration 19.8  
2 Open      Bill   Ptransport_Dur  8.84 
3 Open      Bill   Handling_Dur    0.855
4 Open      Johnny Trial_Duration 27.1  
5 Open      Johnny Ptransport_Dur 18.5  
6 Open      Johnny Handling_Dur    3.01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Getting MEANS &amp; SE for each Individual Duration Category --------------------------</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># TOTAL FEEDING DURATION</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>P1_Feed_SE <span class="ot">=</span> DurSelP1 <span class="sc">%&gt;%</span>  </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Trial_Duration, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Trial_Duration, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>P1_Feed_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 10cm       30.0  19.1    37  3.13
2 5cm        34.5  23.6    38  3.83
3 Open       38.2  30.4    40  4.81</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HANDLING DURATION</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>P1_Hand_SE <span class="ot">=</span> DurSelP1 <span class="sc">%&gt;%</span>  </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Handling_Dur, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Handling_Dur, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>P1_Hand_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 10cm       4.40  6.46    37  1.06
2 5cm        5.29  6.81    38  1.10
3 Open       6.60 14.8     40  2.34</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Swallowing Time</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>P1_Swallow_SE <span class="ot">=</span> DurSelP1 <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>( Ptransport_Dur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Ptransport_Dur, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>P1_Swallow_SE </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 10cm       11.2 11.6     37  1.90
2 5cm        11.6  9.92    38  1.61
3 Open       13.8 12.1     40  1.91</code></pre>
</div>
</div>
</section>
<section id="stats---duration-of-trial-components-feeding-duration-manipulation-duration-swallowing-duration" class="level3">
<h3 class="anchored" data-anchor-id="stats---duration-of-trial-components-feeding-duration-manipulation-duration-swallowing-duration">Stats - Duration of Trial Components [Feeding Duration, Manipulation Duration, Swallowing Duration]</h3>
<p>This section of code is the statistical analysis comparing each of the Trial Duration componants between the three treatments. For each componant (total time feeding, prey handling, and swallowing), the data is fitted with a GLMM model, with eel identity as a repeated measure…followed by estimated marginal means and pairwise comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    TOTAL FEEDING DURATION   #</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data for "Trial Duration"</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>TrialDur_Gamma <span class="ot">&lt;-</span> DurSelP1 <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, Trial_Duration) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  <span class="co"># Convert Eel to a factor</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trial_Duration =</span> <span class="fu">as.numeric</span>(Trial_Duration))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with repeated measures</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>TrialDurationGamma <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Trial_Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> TrialDur_Gamma,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TrialDurationGamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Trial_Duration ~ Treatment + (1 | Eel)
   Data: TrialDur_Gamma

     AIC      BIC   logLik deviance df.resid 
   981.9    995.7   -486.0    971.9      110 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.0767 -0.6749 -0.3387  0.2940  3.4881 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 0.09541  0.3089  
 Residual             0.37944  0.6160  
Number of obs: 115, groups:  Eel, 9

Fixed effects:
              Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)     3.4211     0.1671  20.476   &lt;2e-16 ***
Treatment5cm    0.1390     0.1220   1.140    0.254    
TreatmentOpen   0.1328     0.1245   1.067    0.286    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) Trtmn5
Treatmnt5cm -0.366       
TreatmntOpn -0.388  0.498</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>TrialDurationEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(TrialDurationGamma, <span class="st">"Treatment"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(TrialDurationEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm  -0.13902 0.122 Inf  -1.140  0.4897
 10cm - Open -0.13277 0.124 Inf  -1.067  0.5349
 5cm - Open   0.00625 0.124 Inf   0.051  0.9986

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(TrialDurationEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 10cm        3.42 0.167 Inf      3.09      3.75  a    
 Open        3.55 0.165 Inf      3.23      3.88  a    
 5cm         3.56 0.167 Inf      3.23      3.89  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># TOTAL MANIPULATION DURATION #</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting Handling Duration and adding a small constant value to Handling_Dur to handle 0 values</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>HandDur_Gamma <span class="ot">&lt;-</span> DurSelP1 <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, Handling_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Handling_Dur =</span> Handling_Dur <span class="sc">+</span> <span class="fl">0.001</span>)  <span class="co"># Add a small constant value; rarely, eels would not manipulate prey but would bite and swallow in one movement; to remove 0 values from these isolated instances we added this constant </span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with random intercepts</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>HandDurationGamma<span class="ot">&lt;-</span> <span class="fu">glmer</span>(Handling_Dur <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> HandDur_Gamma,</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HandDurationGamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Handling_Dur ~ Treatment + (1 | Eel)
   Data: HandDur_Gamma

     AIC      BIC   logLik deviance df.resid 
   431.9    445.6   -210.9    421.9      110 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.8346 -0.7790 -0.3567  0.3871  3.6862 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 1.734    1.317   
 Residual             1.435    1.198   
Number of obs: 115, groups:  Eel, 9

Fixed effects:
              Estimate Std. Error t value Pr(&gt;|z|)   
(Intercept)     1.2392     0.4450   2.785  0.00535 **
Treatment5cm    0.1383     0.3741   0.370  0.71159   
TreatmentOpen  -0.1137     0.3940  -0.289  0.77295   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) Trtmn5
Treatmnt5cm -0.416       
TreatmntOpn -0.436  0.467</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>HandDurationEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(HandDurationGamma, <span class="st">"Treatment"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(HandDurationEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm    -0.138 0.374 Inf  -0.370  0.9274
 10cm - Open    0.114 0.394 Inf   0.289  0.9551
 5cm - Open     0.252 0.397 Inf   0.635  0.8010

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(HandDurationEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Open        1.13 0.448 Inf     0.248      2.00  a    
 10cm        1.24 0.445 Inf     0.367      2.11  a    
 5cm         1.38 0.447 Inf     0.502      2.25  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     Pharyngeal Transport    #</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecting Pharyngeal Transport duration and adding a small constant value to  Ptransport_Dur to handle 0 values</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>PT_Gamma <span class="ot">&lt;-</span> DurSelP1 <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, Ptransport_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Ptransport_Dur =</span> Ptransport_Dur<span class="sc">+</span> <span class="fl">0.001</span>)  <span class="co"># Add a small constant value</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with random intercepts</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>PTGamma<span class="ot">&lt;-</span> <span class="fu">glmer</span>(Ptransport_Dur <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> PT_Gamma,</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PTGamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Ptransport_Dur ~ Treatment + (1 | Eel)
   Data: PT_Gamma

     AIC      BIC   logLik deviance df.resid 
   817.8    831.5   -403.9    807.8      110 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.1001 -0.6842 -0.3837  0.2845  3.7468 

Random effects:
 Groups   Name        Variance  Std.Dev. 
 Eel      (Intercept) 1.345e-14 1.160e-07
 Residual             8.261e-01 9.089e-01
Number of obs: 115, groups:  Eel, 9

Fixed effects:
              Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)    2.42033    0.17399  13.910   &lt;2e-16 ***
Treatment5cm   0.03414    0.24444   0.140    0.889    
TreatmentOpen  0.20113    0.24141   0.833    0.405    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) Trtmn5
Treatmnt5cm -0.712       
TreatmntOpn -0.721  0.513
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>PT_EMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(PTGamma, <span class="st">"Treatment"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(PT_EMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm   -0.0341 0.244 Inf  -0.140  0.9893
 10cm - Open  -0.2011 0.241 Inf  -0.833  0.6824
 5cm - Open   -0.1670 0.240 Inf  -0.697  0.7655

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(PT_EMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 10cm        2.42 0.174 Inf      2.08      2.76  a    
 5cm         2.45 0.172 Inf      2.12      2.79  a    
 Open        2.62 0.167 Inf      2.29      2.95  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="graphics---durations-of-trial-components" class="level3">
<h3 class="anchored" data-anchor-id="graphics---durations-of-trial-components">Graphics - Durations of Trial Components</h3>
<p>The next code makes the bar graphs for the trial duration components, comparing the durations feeding, handling prey, and swallowing between the three treatments (open, 10cm, 5cm)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the Future Facets: </span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>Facet_Names_P1_Dur <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Trial_Duration'</span> <span class="ot">=</span> <span class="st">"Total Feeding Duration"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Handling_Dur'</span> <span class="ot">=</span> <span class="st">"Prey Manipulation Duration"</span>,</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Ptransport_Dur'</span> <span class="ot">=</span> <span class="st">"Swallowing Duration"</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>Facet_labeller_P1_Dur <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Facet_Names_P1_Dur[value])</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="co">#The facets of the graph will be the different duration componants: Feeding, Handling, Swallowing</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Making a plot</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>P1_Dur_Graph <span class="ot">=</span> P1_Dur_SE <span class="sc">%&gt;%</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"5cm"</span>, <span class="st">"10cm"</span>, <span class="st">"Open"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Duration =</span> <span class="fu">fct_relevel</span>(Duration, <span class="st">"Trial_Duration"</span>,<span class="st">"Handling_Dur"</span>, <span class="st">"Ptransport_Dur"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bar </span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">25</span>) <span class="sc">+</span> </span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>,<span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>)) <span class="sc">+</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_x_discrete(labels=c("Small","Medium", "Large"))+</span></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mean Duration (Sec)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet wrap + the label code from above for our new label names</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Duration, <span class="at">labeller =</span> Facet_labeller_P1_Dur, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face=</span><span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `labeller` API has been updated. Labellers taking `variable` and `value`
arguments are now deprecated.
ℹ See labellers documentation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>P1_Dur_Graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/-%20Trial%20Durations%20Graphics-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saves to reports folder within the project</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P1-TrialComponents.png"</span>, <span class="at">plot =</span> P1_Dur_Graph, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="behavior-duration" class="level2">
<h2 class="anchored" data-anchor-id="behavior-duration">⏰⏰⏰ BEHAVIOR DURATION ⏰⏰⏰</h2>
<p>This next chapter of code compares the time spent engaged in different prey manipulation behaviors between treatments. Because there was no significant difference in total manipulation time (see previous) between treatments, we used the total duration engaged in each behavior (Example Column: Shaking_Duration), as opposed to proportional data (out of total feeding or handling time)</p>
<section id="data-prep---duration-of-behaviors" class="level3">
<h3 class="anchored" data-anchor-id="data-prep---duration-of-behaviors">Data Prep - Duration of Behaviors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  `Trial info` Treatment Eel    Trial_Duration Handling_Dur Bites Ptransport_Dur
  &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt;
1 R1 - T1      Open      Bill             19.8        0.855     8           8.84
2 R1 - T1      Open      Johnny           27.1        3.01     12          18.5 
3 R1 - T1      Open      Snick…           77.7       12.3      36          60.6 
4 R1 - T2      Open      Horat…           10.6        0.685     5           5.08
5 R1 - T2      Open      Spagh…           83.2        5.76     24          39   
6 R1 - T2      Open      Eelvis           88         44.5      13           2.8 
# ℹ 14 more variables: Ptransport_Prop &lt;dbl&gt;, Shaking_Dur &lt;dbl&gt;,
#   Shaking_Prop &lt;dbl&gt;, Shaking_Prop_Handling &lt;dbl&gt;, Knotting_Dur &lt;dbl&gt;,
#   Knotting_Prop &lt;dbl&gt;, Knotting_Prop_Handling &lt;dbl&gt;, Knotting_Binomial &lt;chr&gt;,
#   Rotating_Dur &lt;dbl&gt;, Rotating_Prop &lt;dbl&gt;, Rotating_Prop_Handling &lt;dbl&gt;,
#   Ramming_Dur &lt;dbl&gt;, Ramming_Prop &lt;dbl&gt;, Ramming_Prop_Handling &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting the columns we want:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>SelBehaviorDurationsP1 <span class="ot">&lt;-</span> P1 <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, Eel, Shaking_Dur, Ramming_Dur, Knotting_Dur, Rotating_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SelBehaviorDurationsP1) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Treatment Eel        Shaking_Dur Ramming_Dur Knotting_Dur Rotating_Dur
  &lt;chr&gt;     &lt;chr&gt;            &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;
1 Open      Bill             0.855        0            0           0    
2 Open      Johnny           0            0            0           3.01 
3 Open      Snickers         0.97         1.75         6.5         3.06 
4 Open      Horatio          0.685        0            0           0    
5 Open      Spaghettio       0            0            4.46        1.3  
6 Open      Eelvis           0            7.7         36.3         0.518</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing to long format </span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>P1BehaviorDur_Long <span class="ot">&lt;-</span> SelBehaviorDurationsP1 <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Shaking_Dur, Ramming_Dur, Knotting_Dur, Rotating_Dur), </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Behavior"</span>, </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Duration"</span>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Mean &amp; SE For Graphics</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>P1BehaviorDurSE <span class="ot">&lt;-</span> P1BehaviorDur_Long <span class="sc">%&gt;%</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment, Behavior) <span class="sc">%&gt;%</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>P1BehaviorDurSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
# Groups:   Treatment [3]
   Treatment Behavior       mean     sd     n     se
   &lt;chr&gt;     &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
 1 10cm      Knotting_Dur 1.76    2.92     37 0.480 
 2 10cm      Ramming_Dur  0.0954  0.390    37 0.0642
 3 10cm      Rotating_Dur 1.92    4.37     37 0.718 
 4 10cm      Shaking_Dur  0.622   0.759    37 0.125 
 5 5cm       Knotting_Dur 1.47    3.91     38 0.635 
 6 5cm       Ramming_Dur  0.228   1.17     38 0.190 
 7 5cm       Rotating_Dur 2.92    4.71     38 0.764 
 8 5cm       Shaking_Dur  0.676   0.845    38 0.137 
 9 Open      Knotting_Dur 4.62   12.2      40 1.93  
10 Open      Ramming_Dur  0.877   2.77     40 0.438 
11 Open      Rotating_Dur 0.692   0.940    40 0.149 
12 Open      Shaking_Dur  0.403   0.579    40 0.0916</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making treatment a factor:</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>P1BehaviorDurSE<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(P1BehaviorDurSE<span class="sc">$</span>Treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stats---duration-of-behaviors" class="level3">
<h3 class="anchored" data-anchor-id="stats---duration-of-behaviors">Stats - Duration of Behaviors</h3>
<p>The next code is the statistical analysis, comparing the time spent engaged in each behavior (ramming, rotating, shaking, knotting) between the treatments (open, 10cm, 5cm). To compare average duration spent engaged in each behavior, we fit the data for each behavior with a GLMM using a Tweedie distribution. The data is not normal and shows overdisperson making other distributions less suitable. The Tweedie distribution encompasses a wide range of distribution shapes and is also well suited for modeling continuous positive data inclusive of 0 values.</p>
<p>Each behavior has an emoji header to quickly find each chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  ROTATING STATS</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the ROTATING duration data</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>RotatingTweedie <span class="ot">&lt;-</span> P1BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Rotating_Dur"</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>RotatingTweedie_Mod  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> RotatingTweedie,</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">family =</span> tweedie)</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RotatingTweedie_Mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: RotatingTweedie

     AIC      BIC   logLik deviance df.resid 
   422.9    439.3   -205.4    410.9      109 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.5377   0.7333  
Number of obs: 115, groups:  Eel, 9

Dispersion parameter for tweedie family (): 2.88 

Conditional model:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)     0.4285     0.3564   1.202   0.2292  
Treatment5cm    0.4476     0.3196   1.400   0.1614  
TreatmentOpen  -0.9017     0.3894  -2.316   0.0206 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>RotatingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(RotatingTweedie_Mod, <span class="st">"Treatment"</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(RotatingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm    -0.448 0.320 Inf  -1.400  0.3407
 10cm - Open    0.902 0.389 Inf   2.316  0.0537
 5cm - Open     1.349 0.371 Inf   3.632  0.0008

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(RotatingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Open      -0.473 0.392 Inf    -1.241     0.295  a    
 10cm       0.429 0.356 Inf    -0.270     1.127  ab   
 5cm        0.876 0.336 Inf     0.219     1.534   b   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   RAMMING STATS</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the RAMMING duration data</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>RammingTweedie <span class="ot">&lt;-</span> P1BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Ramming_Dur"</span>)</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>RammingTweedie_Mod  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> RammingTweedie,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> tweedie)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RammingTweedie_Mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: RammingTweedie

     AIC      BIC   logLik deviance df.resid 
   139.1    155.6    -63.6    127.1      109 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 1.591    1.261   
Number of obs: 115, groups:  Eel, 9

Dispersion parameter for tweedie family ():  7.3 

Conditional model:
              Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)    -2.7457     1.0629  -2.583  0.00978 **
Treatment5cm    0.6843     1.1563   0.592  0.55397   
TreatmentOpen   1.8185     1.0700   1.700  0.08922 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>RammingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(RammingTweedie_Mod, <span class="st">"Treatment"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(RammingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm    -0.684 1.156 Inf  -0.592  0.8245
 10cm - Open   -1.819 1.070 Inf  -1.700  0.2053
 5cm - Open    -1.134 0.951 Inf  -1.193  0.4571

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(RammingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 10cm      -2.746 1.063 Inf     -4.83    -0.663  a    
 5cm       -2.061 0.985 Inf     -3.99    -0.131  a    
 Open      -0.927 0.878 Inf     -2.65     0.793  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  SHAKING STATS </span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the SHAKING DURATION Data</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>ShakingTweedie <span class="ot">&lt;-</span> P1BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Shaking_Dur"</span>)</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>ShakingTweedie_Mod  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> ShakingTweedie,</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">family =</span> tweedie)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ShakingTweedie_Mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: ShakingTweedie

     AIC      BIC   logLik deviance df.resid 
   246.5    263.0   -117.2    234.5      109 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.9616   0.9806  
Number of obs: 115, groups:  Eel, 9

Dispersion parameter for tweedie family (): 0.744 

Conditional model:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)    -0.7446     0.3813  -1.953   0.0508 .
Treatment5cm    0.1049     0.2446   0.429   0.6680  
TreatmentOpen  -0.5539     0.2712  -2.042   0.0411 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>ShakingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(ShakingTweedie_Mod, <span class="st">"Treatment"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(ShakingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 10cm - 5cm    -0.105 0.245 Inf  -0.429  0.9036
 10cm - Open    0.554 0.271 Inf   2.042  0.1022
 5cm - Open     0.659 0.267 Inf   2.464  0.0366

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(ShakingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Open      -1.298 0.397 Inf     -2.08  -0.51943  a    
 10cm      -0.745 0.381 Inf     -1.49   0.00269  ab   
 5cm       -0.640 0.378 Inf     -1.38   0.10073   b   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># KNOTTING STATS </span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co">#🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢🪢</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Making treatment a factor:</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>P1BehaviorDur_Long<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(P1BehaviorDur_Long<span class="sc">$</span>Treatment)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the SHAKING DURATION Data</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>KnottingTweedie <span class="ot">&lt;-</span> P1BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Knotting_Dur"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">relevel</span>(Treatment, <span class="at">ref =</span> <span class="st">"Open"</span>))</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>KnottingTweedie_Mod  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> KnottingTweedie,</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">family =</span> tweedie)</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(KnottingTweedie_Mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: KnottingTweedie

     AIC      BIC   logLik deviance df.resid 
   341.4    357.9   -164.7    329.4      109 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 2.505    1.583   
Number of obs: 115, groups:  Eel, 9

Dispersion parameter for tweedie family ():  5.4 

Conditional model:
              Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)     0.4291     0.6533   0.657   0.5113  
Treatment10cm  -0.5803     0.4129  -1.406   0.1599  
Treatment5cm   -0.7944     0.4450  -1.785   0.0743 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>KnottingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(KnottingTweedie_Mod, <span class="st">"Treatment"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(KnottingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast    estimate    SE  df z.ratio p.value
 Open - 10cm    0.580 0.413 Inf   1.405  0.3380
 Open - 5cm     0.794 0.445 Inf   1.785  0.1746
 10cm - 5cm     0.214 0.488 Inf   0.438  0.8996

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(KnottingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 5cm       -0.365 0.695 Inf    -1.728     0.998  a    
 10cm      -0.151 0.671 Inf    -1.467     1.165  a    
 Open       0.429 0.653 Inf    -0.851     1.710  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="graphics---duration-of-behaviors" class="level3">
<h3 class="anchored" data-anchor-id="graphics---duration-of-behaviors">Graphics - Duration of Behaviors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This graph shows the average DURATION spent in each behavior.</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0's have been left in the dataset </span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the Future Facets:</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>Facet_Names_P1_BehaviorDur <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Knotting_Dur'</span> <span class="ot">=</span> <span class="st">"KNOTTING"</span>,</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Ramming_Dur'</span> <span class="ot">=</span> <span class="st">"RAMMING"</span>,</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Rotating_Dur'</span> <span class="ot">=</span> <span class="st">"ROTATING"</span>,</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Shaking_Dur'</span> <span class="ot">=</span> <span class="st">"SHAKING"</span>)</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>Facet_labeller_BehaviorDur<span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Facet_Names_P1_BehaviorDur[value])}</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Wrangling some pictures for the future</span></span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>KnotPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Knotting.png"</span>) </span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>ShakePic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Shaking.png"</span>)</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>RotatePic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Rotating.png"</span>)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>RamPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Ramming.png"</span>)</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a data frame with pairwise significance: </span></span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>p1_handdur_signif <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Treatment, <span class="sc">~</span>Behavior,     <span class="sc">~</span>Signif,</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,   <span class="st">"Knotting_Dur"</span>, <span class="st">"a"</span>,    </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10cm"</span>,   <span class="st">"Knotting_Dur"</span>, <span class="st">"a"</span>,   </span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5cm"</span>,    <span class="st">"Knotting_Dur"</span>, <span class="st">"a"</span>,    </span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,    <span class="st">"Ramming_Dur"</span>, <span class="st">"a"</span>,    </span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10cm"</span>,   <span class="st">"Ramming_Dur"</span>, <span class="st">"a"</span>,   </span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5cm"</span>,    <span class="st">"Ramming_Dur"</span>, <span class="st">"a"</span>,   </span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,    <span class="st">"Rotating_Dur"</span>, <span class="st">"b"</span>,    </span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10cm"</span>,   <span class="st">"Rotating_Dur"</span>, <span class="st">"ab"</span>,   </span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5cm"</span>,    <span class="st">"Rotating_Dur"</span>, <span class="st">"a"</span>,    </span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,    <span class="st">"Shaking_Dur"</span>, <span class="st">"b"</span>,    </span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"10cm"</span>,   <span class="st">"Shaking_Dur"</span>, <span class="st">"ab"</span>,   </span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"5cm"</span>,    <span class="st">"Shaking_Dur"</span>, <span class="st">"a"</span> </span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">transmute</span>(P1BehaviorDurSE, Treatment, Behavior, mean, se),</span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Behavior"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"5cm"</span>, <span class="st">"10cm"</span>, <span class="st">"Open"</span>),</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">Behavior =</span> <span class="fu">factor</span>(Behavior),</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> mean <span class="sc">+</span> se <span class="sc">+</span> <span class="fl">0.5</span>)</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a><span class="co"># The graph:</span></span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>P1_BehaviorDur <span class="ot">=</span> P1BehaviorDurSE <span class="sc">%&gt;%</span> </span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"5cm"</span>, <span class="st">"10cm"</span>, <span class="st">"Open"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Adding error bars: </span></span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Adding Significance Labels</span></span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> Signif), p1_handdur_signif, <span class="at">size =</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#All other aesthetics:</span></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>, <span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>)) <span class="sc">+</span></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"5cm"</span>,<span class="st">"10cm"</span>, <span class="st">"Open"</span>))<span class="sc">+</span></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mean Duration in Behavior (Sec)"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Behavior, <span class="at">labeller =</span> Facet_labeller_BehaviorDur) <span class="sc">+</span></span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `labeller` API has been updated. Labellers taking `variable` and `value`
arguments are now deprecated.
ℹ See labellers documentation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>P1_BehaviorDur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/PHASE%201-%20Graphics%20-%20Average%20Durations%20of%20Behaviors%20(Not%20Proportion)-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>P1_BehaviorDur_Pics <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>(P1_BehaviorDur) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(KnotPic, <span class="at">x=</span><span class="fl">0.35</span> , <span class="at">y=</span><span class="fl">0.89</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">17</span>, width</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(RamPic, <span class="at">x=</span><span class="fl">0.85</span> , <span class="at">y=</span><span class="fl">0.89</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">2</span>, width</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">2</span> ) <span class="sc">+</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(RotatePic, <span class="at">x=</span><span class="fl">0.43</span> , <span class="at">y=</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">24</span>, width</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">24</span> ) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(ShakePic, <span class="at">x=</span><span class="fl">0.86</span> , <span class="at">y=</span><span class="fl">0.46</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">2</span>, width</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">2</span> ) </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>P1_BehaviorDur_Pics </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/PHASE%201-%20Graphics%20-%20Average%20Durations%20of%20Behaviors%20(Not%20Proportion)-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P1-BehaviorDuration.png"</span>, <span class="at">plot =</span> P1_BehaviorDur_Pics, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section" class="level1">
<h1>————————————</h1>
<section id="experiment-1---final-figure-graphic" class="level2">
<h2 class="anchored" data-anchor-id="experiment-1---final-figure-graphic">Experiment 1 - FINAL FIGURE Graphic</h2>
</section>
</section>
<section id="section-1" class="level1">
<h1>———————————–</h1>
<p>The code below combines the Trial Component Figure with the Behavior Duration Figure for Experiment 1</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>P1_FinalFigure <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(P1_Dur_Graph, P1_BehaviorDur_Pics,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>P1_FinalFigure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/P1%20Final%20Figure%20-%20Combining%20Exp%202%20Figures-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P1_Final.png"</span>, <span class="at">plot =</span> P1_FinalFigure, <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="experiment-2-enclosed-spatial-trials" class="level1">
<h1>EXPERIMENT 2: Enclosed Spatial Trials</h1>
<p>In Experiment 2, our aim was to document the spatial threshold relative to eel size that might limit more three-dimensional movement (i.e.&nbsp;knotting). Treatments (small, medium, and large) were scaled to individual diameters of the moray. The large treatment was 2 x the eel diameter, the medium treatment 1.5 x the eel’s diameter,and the small treatment we scaled to be the exact diameter of the eel plus 10% of the eel’s diameter.</p>
<p>We included two new behaviors in our analysis: tail and body anchoring</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading in the dataset</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>P2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Phase2-SpatialContext2.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 58 Columns: 37
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): Eel, Treatment, Knotting_Binomial
dbl (34): Treatment_Round, Trial_Duration, Handling_Dur, Handling-PT, PT_Dur...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 37
  Eel        Treatment Treatment_Round Trial_Duration Handling_Dur `Handling-PT`
  &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 Eelvis     Small                   1           50.4        16.1           49.3
2 Snickers   Small                   1           32.2         8.05          29.6
3 Bill       Small                   1           27.4        10.3           19.4
4 Hamlet     Small                   1           38.2        15.0           24.8
5 Horatio    Small                   1           30.4        40.7           17.9
6 Spaghettio Small                   1           45.9        51.7           42.9
# ℹ 31 more variables: PT_Duration &lt;dbl&gt;, PT_Prop &lt;dbl&gt;,
#   Knotting_Duration &lt;dbl&gt;, Knotting_Prop &lt;dbl&gt;, Knotting_Prop_Handling &lt;dbl&gt;,
#   Knotting_Binomial &lt;chr&gt;, Rotating_Duration &lt;dbl&gt;, Rotating_Prop &lt;dbl&gt;,
#   Rotating_Prop_Handling &lt;dbl&gt;, Ramming_Duration &lt;dbl&gt;, Ramming_Prop &lt;dbl&gt;,
#   Ramming_Prop_Handling &lt;dbl&gt;, Shaking_Duration &lt;dbl&gt;, Shaking_Prop &lt;dbl&gt;,
#   Shaking_Prop_Handling &lt;dbl&gt;, Crinkle_Duration &lt;dbl&gt;, Crinkle_Prop &lt;dbl&gt;,
#   Crinkle_Prop_Handling &lt;dbl&gt;, Tug_Duration &lt;dbl&gt;, Tug_Prop &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>P2 data contains: Treatment = ‘small’, ‘medium’, ‘large’ Eel = name of the individual Treatment_Round = individual’s exposure to the treatment (1st time, 2nd time, etc.) Trial_Duration = Duration of time in seconds from first bite to completion of swallowing Handling_Duration = Time in seconds spent engaged in at least one of the prey manipulation behaviors PT_Duration = The duration of time in seconds engaged in swallowing (pharyngeal transport)</p>
<p>All behaviors (shaking, ramming, rotating, knotting, crinkle, anchor, tug) have three columns: Example - Shaking_Dur = the total duration spent shaking Shaking_Prop = Proportion of time spent shaking out of the total Trial_Duration Shaking_Prop_Handling = Proportion of time spent shaking out of the total Handling_Dur</p>
<ul>
<li>Tug was not included in analysis, as it could not be fully seperated from other behaviors</li>
<li>‘crinkle’ in the data set is code for ‘body anchoring’ in the manuscript; where an eel forms a ‘w’ shape, pressing on the tube walls.</li>
<li>‘anchor’ in the data set refers specifically to tail anchoring</li>
</ul>
<p>Knotting_Binomial = was knotting observed, yes/no</p>
<section id="trial-component-duration" class="level2">
<h2 class="anchored" data-anchor-id="trial-component-duration">⌛️⌛️⌛️ TRIAL COMPONENT DURATION ⌛⌛⌛️</h2>
<p>This section of code focuses on the total feeding time (Trial_Duration), the time spent handling prey (Handling_Duration), and the time spent swallowing prey (PT_Duration) between treatments (small, medium, large)</p>
<section id="data-prep---duration-of-trial-components" class="level3">
<h3 class="anchored" data-anchor-id="data-prep---duration-of-trial-components">Data Prep - Duration of Trial Components</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting the columns we want:</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>DurSelP2 <span class="ot">&lt;-</span> P2 <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, Eel, Trial_Duration, PT_Duration, Handling_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(DurSelP2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  Treatment Eel        Trial_Duration PT_Duration Handling_Dur
  &lt;chr&gt;     &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 Small     Eelvis               50.4        1.17        16.1 
2 Small     Snickers             32.2        2.62         8.05
3 Small     Bill                 27.4        7.99        10.3 
4 Small     Hamlet               38.2       13.3         15.0 
5 Small     Horatio              30.4       12.5         40.7 
6 Small     Spaghettio           45.9        3.01        51.7 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making treatment a factor:</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>DurSelP2<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(DurSelP2<span class="sc">$</span>Treatment)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Prepping a dataframe for Graphics </span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>P2_Dur_Long <span class="ot">&lt;-</span> DurSelP2 <span class="sc">%&gt;%</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Trial_Duration, PT_Duration, Handling_Dur), </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Duration"</span>, </span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Time"</span>)</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Making Duration a factor:</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>P2_Dur_Long<span class="sc">$</span>Duration <span class="ot">=</span> <span class="fu">factor</span>(P2_Dur_Long<span class="sc">$</span>Duration)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P2_Dur_Long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Treatment Eel      Duration        Time
  &lt;fct&gt;     &lt;chr&gt;    &lt;fct&gt;          &lt;dbl&gt;
1 Small     Eelvis   Trial_Duration 50.4 
2 Small     Eelvis   PT_Duration     1.17
3 Small     Eelvis   Handling_Dur   16.1 
4 Small     Snickers Trial_Duration 32.2 
5 Small     Snickers PT_Duration     2.62
6 Small     Snickers Handling_Dur    8.05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculating Mean &amp; SE For Graphics - This code is used to create future bar graphs comparing the mean time spent engaged in feeding, prey handling, and swallowing between treatments</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>P2_Dur_SE <span class="ot">=</span> P2_Dur_Long <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Duration, Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Duration'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P2_Dur_SE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   Duration [2]
  Duration     Treatment  mean    sd     n    se
  &lt;fct&gt;        &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Handling_Dur Large     16.6   9.66    21  2.11
2 Handling_Dur Medium    21.4  17.0     20  3.81
3 Handling_Dur Small     23.8  15.1     17  3.65
4 PT_Duration  Large      8.41  6.14    21  1.34
5 PT_Duration  Medium     8.64  6.01    20  1.34
6 PT_Duration  Small      8.72  7.29    17  1.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- Getting MEANS &amp; SE for each Individual Duration Category --------------------------</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># TOTAL FEEDING DURATION</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>P2_Feed_SE<span class="ot">=</span>DurSelP2 <span class="sc">%&gt;%</span>  </span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(Trial_Duration, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(Trial_Duration, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>P2_Feed_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Large      47.3  35.3    21  7.69
2 Medium     62.2  68.4    20 15.3 
3 Small      39.4  17.0    17  4.13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># HANDLING DURATION</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>P2_Hand_SE<span class="ot">=</span>DurSelP2<span class="sc">%&gt;%</span>  </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span> <span class="co">#</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean=</span><span class="fu">mean</span>(Handling_Dur, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd=</span><span class="fu">sd</span>(Handling_Dur, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n=</span><span class="fu">n</span>(),</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se=</span>sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>P2_Hand_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Large      16.6  9.66    21  2.11
2 Medium     21.4 17.0     20  3.81
3 Small      23.8 15.1     17  3.65</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># SWALLOWING DURATION</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------- #</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>P2_Swallow_SE <span class="ot">=</span> DurSelP2 <span class="sc">%&gt;%</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>( PT_Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(PT_Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>P2_Swallow_SE </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Treatment  mean    sd     n    se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Large      8.41  6.14    21  1.34
2 Medium     8.64  6.01    20  1.34
3 Small      8.72  7.29    17  1.77</code></pre>
</div>
</div>
</section>
<section id="stats---duration-of-trial-components" class="level3">
<h3 class="anchored" data-anchor-id="stats---duration-of-trial-components">Stats - Duration of Trial Components</h3>
<p>This section of code is the statistical analysis comparing each of the Trial Duration componants between the three treatments. For each componant (total time feeding, prey handling, and swallowing), the data is fitted with a GLMM model, with eel identity as a repeated measure…followed by estimated marginal means and pairwise comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subset the data for "Trial Duration"</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>TrialDur2_Gamma <span class="ot">&lt;-</span> DurSelP2 <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, Trial_Duration) <span class="sc">%&gt;%</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  <span class="co"># Convert Eel to a factor</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trial_Duration =</span> <span class="fu">as.numeric</span>(Trial_Duration))</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with repeated measures, adjusting optimization settings</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>TrialDuration2Gamma <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Trial_Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> TrialDur2_Gamma,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TrialDuration2Gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Trial_Duration ~ Treatment + (1 | Eel)
   Data: TrialDur2_Gamma

     AIC      BIC   logLik deviance df.resid 
   546.6    556.9   -268.3    536.6       53 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.0527 -0.7165 -0.2225  0.4843  3.2157 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 0.1528   0.3908  
 Residual             0.3934   0.6272  
Number of obs: 58, groups:  Eel, 8

Fixed effects:
                Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)      3.80443    0.22848  16.651   &lt;2e-16 ***
TreatmentMedium  0.03748    0.17664   0.212    0.832    
TreatmentSmall  -0.03303    0.17636  -0.187    0.851    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) TrtmnM
TreatmntMdm -0.331       
TretmntSmll -0.325  0.419</code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>TrialDuration2EMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(TrialDuration2Gamma, <span class="st">"Treatment"</span>)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(TrialDuration2EMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium  -0.0375 0.177 Inf  -0.212  0.9755
 Large - Small    0.0330 0.176 Inf   0.187  0.9808
 Medium - Small   0.0705 0.190 Inf   0.371  0.9271

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(TrialDuration2EMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Small       3.77 0.239 Inf      3.30      4.24  a    
 Large       3.80 0.228 Inf      3.36      4.25  a    
 Medium      3.84 0.238 Inf      3.38      4.31  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Handling Duration  #</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a small constant value to Handling_Dur to handle 0 values</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>HandDur2_Gamma <span class="ot">&lt;-</span> DurSelP2 <span class="sc">%&gt;%</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, Handling_Dur) <span class="sc">%&gt;%</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  </span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Handling_Dur =</span> Handling_Dur <span class="sc">+</span> <span class="fl">0.001</span>)  <span class="co"># Add a small constant value</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with random intercepts</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>HandDuration2Gamma<span class="ot">&lt;-</span> <span class="fu">glmer</span>(Handling_Dur <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> HandDur2_Gamma,</span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HandDuration2Gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Handling_Dur ~ Treatment + (1 | Eel)
   Data: HandDur2_Gamma

     AIC      BIC   logLik deviance df.resid 
   462.6    472.9   -226.3    452.6       53 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.4526 -0.7695 -0.3683  0.6058  3.0399 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 0.002535 0.05035 
 Residual             0.435974 0.66028 
Number of obs: 58, groups:  Eel, 8

Fixed effects:
                Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)       2.8065     0.1557  18.028   &lt;2e-16 ***
TreatmentMedium   0.2499     0.2220   1.125    0.260    
TreatmentSmall    0.3640     0.2295   1.586    0.113    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) TrtmnM
TreatmntMdm -0.655       
TretmntSmll -0.662  0.442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>HandDuration2EMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(HandDuration2Gamma, <span class="st">"Treatment"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(HandDuration2EMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium   -0.250 0.222 Inf  -1.125  0.4984
 Large - Small    -0.364 0.229 Inf  -1.586  0.2516
 Medium - Small   -0.114 0.238 Inf  -0.479  0.8814

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(HandDuration2EMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Large       2.81 0.156 Inf      2.50      3.11  a    
 Medium      3.06 0.168 Inf      2.73      3.39  a    
 Small       3.17 0.172 Inf      2.83      3.51  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pharyngeal Transport #</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>PT2_Gamma <span class="ot">&lt;-</span> DurSelP2 <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Eel, Treatment, PT_Duration) <span class="sc">%&gt;%</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">factor</span>(Treatment),</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Eel =</span> <span class="fu">factor</span>(Eel),  </span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">PT_Duration =</span> PT_Duration <span class="sc">+</span> <span class="fl">0.001</span>)  <span class="co"># Add a small constant value</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with random intercepts</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>PT2Gamma<span class="ot">&lt;-</span> <span class="fu">glmer</span>(PT_Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> PT2_Gamma,</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PT2Gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: PT_Duration ~ Treatment + (1 | Eel)
   Data: PT2_Gamma

     AIC      BIC   logLik deviance df.resid 
   377.8    388.1   -183.9    367.8       53 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.3674 -0.8195 -0.1740  0.5566  3.5107 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 0.0000   0.0000  
 Residual             0.5347   0.7312  
Number of obs: 58, groups:  Eel, 8

Fixed effects:
                Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)      2.12949    0.22764   9.355   &lt;2e-16 ***
TreatmentMedium  0.02703    0.32593   0.083    0.934    
TreatmentSmall   0.03678    0.34034   0.108    0.914    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) TrtmnM
TreatmntMdm -0.698       
TretmntSmll -0.669  0.467
optimizer (Nelder_Mead) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>PT2_EMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(PT2Gamma, <span class="st">"Treatment"</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(PT2_EMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium -0.02703 0.326 Inf  -0.083  0.9962
 Large - Small  -0.03678 0.340 Inf  -0.108  0.9936
 Medium - Small -0.00976 0.344 Inf  -0.028  0.9996

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(PT2_EMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Large       2.13 0.228 Inf      1.68      2.58  a    
 Medium      2.16 0.233 Inf      1.70      2.61  a    
 Small       2.17 0.253 Inf      1.67      2.66  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="graphics---duration-of-trial-components" class="level3">
<h3 class="anchored" data-anchor-id="graphics---duration-of-trial-components">Graphics - Duration of Trial Components</h3>
<p>The next code makes the bar graphs for the trial duration components, comparing the durations feeding, handling prey, and swallowing between the three treatments (small, medium, large).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GRAPH FACETS = DURATIONS </span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the Future Facets</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>Facet_Names_P2_Dur <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Trial_Duration'</span> <span class="ot">=</span> <span class="st">"Total Feeding Duration"</span>,</span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Handling_Dur'</span> <span class="ot">=</span> <span class="st">"Prey Manipulation Duration"</span>,</span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'PT_Duration'</span> <span class="ot">=</span> <span class="st">"Swallowing Duration"</span>)</span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>Facet_labeller_P2_Dur <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Facet_Names_P2_Dur[value])</span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Making a plot</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>P2_Dur_Graph <span class="ot">=</span> P2_Dur_SE <span class="sc">%&gt;%</span> </span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Duration =</span> <span class="fu">fct_relevel</span>(Duration, <span class="st">"Trial_Duration"</span>,<span class="st">"Handling_Dur"</span>, <span class="st">"PT_Duration"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bar </span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">25</span>) <span class="sc">+</span> </span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>,<span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>)) <span class="sc">+</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mean Duration (Sec)"</span>, <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet wrap + the label code from above for our new label names</span></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Duration, <span class="at">labeller =</span> Facet_labeller_P2_Dur, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `labeller` API has been updated. Labellers taking `variable` and `value`
arguments are now deprecated.
ℹ See labellers documentation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>P2_Dur_Graph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/Phase%202%20-%20Graphics%20-%20Duration%20of%20Trial%20Components-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saves to reports folder within the project</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P2-Trial Components.png"</span>, <span class="at">plot =</span> P2_Dur_Graph, <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="behavior-duration-1" class="level2">
<h2 class="anchored" data-anchor-id="behavior-duration-1">⏰ ⏰ ⏰ BEHAVIOR DURATION ⏰⏰⏰</h2>
<p>This next chapter of code compares the time spent engaged in different prey manipulation behaviors between treatments. Because there was no significant difference in total manipulation time (see previous) between treatments, we used the total duration engaged in each behavior (Example Column: ‘Shaking_Duration’), as opposed to proportional data (out of total feeding or handling time)</p>
<section id="data-prep---duration-of-behaviors-1" class="level3">
<h3 class="anchored" data-anchor-id="data-prep---duration-of-behaviors-1">Data Prep - Duration of Behaviors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(P2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 37
  Eel        Treatment Treatment_Round Trial_Duration Handling_Dur `Handling-PT`
  &lt;chr&gt;      &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;         &lt;dbl&gt;
1 Eelvis     Small                   1           50.4        16.1           49.3
2 Snickers   Small                   1           32.2         8.05          29.6
3 Bill       Small                   1           27.4        10.3           19.4
4 Hamlet     Small                   1           38.2        15.0           24.8
5 Horatio    Small                   1           30.4        40.7           17.9
6 Spaghettio Small                   1           45.9        51.7           42.9
# ℹ 31 more variables: PT_Duration &lt;dbl&gt;, PT_Prop &lt;dbl&gt;,
#   Knotting_Duration &lt;dbl&gt;, Knotting_Prop &lt;dbl&gt;, Knotting_Prop_Handling &lt;dbl&gt;,
#   Knotting_Binomial &lt;chr&gt;, Rotating_Duration &lt;dbl&gt;, Rotating_Prop &lt;dbl&gt;,
#   Rotating_Prop_Handling &lt;dbl&gt;, Ramming_Duration &lt;dbl&gt;, Ramming_Prop &lt;dbl&gt;,
#   Ramming_Prop_Handling &lt;dbl&gt;, Shaking_Duration &lt;dbl&gt;, Shaking_Prop &lt;dbl&gt;,
#   Shaking_Prop_Handling &lt;dbl&gt;, Crinkle_Duration &lt;dbl&gt;, Crinkle_Prop &lt;dbl&gt;,
#   Crinkle_Prop_Handling &lt;dbl&gt;, Tug_Duration &lt;dbl&gt;, Tug_Prop &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting the columns we want:</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>SelBehaviorDurationsP2 <span class="ot">&lt;-</span> P2 <span class="sc">%&gt;%</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, Eel, Shaking_Duration, Ramming_Duration, Knotting_Duration, Rotating_Duration, Anchor_Duration, Crinkle_Duration) <span class="sc">%&gt;%</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SelBehaviorDurationsP2) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  Treatment Eel        Shaking_Duration Ramming_Duration Knotting_Duration
  &lt;chr&gt;     &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;
1 Small     Eelvis                0                    0                 0
2 Small     Snickers              1.13                 0                 0
3 Small     Bill                  0.504                0                 0
4 Small     Hamlet                0.403                0                 0
5 Small     Horatio               0                    0                 0
6 Small     Spaghettio            0                    0                 0
# ℹ 3 more variables: Rotating_Duration &lt;dbl&gt;, Anchor_Duration &lt;dbl&gt;,
#   Crinkle_Duration &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>P2BehaviorDur_Long <span class="ot">&lt;-</span> SelBehaviorDurationsP2 <span class="sc">%&gt;%</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Shaking_Duration, Ramming_Duration, Knotting_Duration, Rotating_Duration, Anchor_Duration, Crinkle_Duration), </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Behavior"</span>, </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Duration"</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Mean &amp; SE - 0's included</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>P2BehaviorDurSE <span class="ot">=</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment, Behavior) <span class="sc">%&gt;%</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>P2BehaviorDurSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 18 × 6
# Groups:   Treatment [3]
   Treatment Behavior             mean     sd     n     se
   &lt;chr&gt;     &lt;chr&gt;               &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
 1 Large     Anchor_Duration    2.22    4.14     20 0.925 
 2 Large     Crinkle_Duration   2.17    2.33     20 0.522 
 3 Large     Knotting_Duration  2.81    4.67     20 1.04  
 4 Large     Ramming_Duration   0       0        20 0     
 5 Large     Rotating_Duration  9.15    9.36     20 2.09  
 6 Large     Shaking_Duration   0.635   0.986    20 0.220 
 7 Medium    Anchor_Duration    2.34    2.95     20 0.660 
 8 Medium    Crinkle_Duration   6.31    7.00     20 1.57  
 9 Medium    Knotting_Duration  0       0        20 0     
10 Medium    Ramming_Duration   1.76    5.73     20 1.28  
11 Medium    Rotating_Duration 10.4    12.3      20 2.76  
12 Medium    Shaking_Duration   0.537   0.701    20 0.157 
13 Small     Anchor_Duration    6.15    6.23     17 1.51  
14 Small     Crinkle_Duration   9.40    9.14     17 2.22  
15 Small     Knotting_Duration  0       0        17 0     
16 Small     Ramming_Duration   0.0737  0.304    17 0.0737
17 Small     Rotating_Duration  7.47    8.41     17 2.04  
18 Small     Shaking_Duration   0.724   0.739    17 0.179 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making treatment a factor:</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>P2BehaviorDurSE<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(P2BehaviorDurSE<span class="sc">$</span>Treatment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="stats---duration-of-behaviors-1" class="level3">
<h3 class="anchored" data-anchor-id="stats---duration-of-behaviors-1">Stats - Duration of Behaviors</h3>
<p>The next code is the statistical analysis, comparing the time spent engaged in each behavior (ramming, rotating, shaking, knotting, body anchoring [aka ‘crinkle’], and tail anchoring [aka ‘anchor’]) between the treatments (small, medium, large). To compare average duration spent engaged in each behavior, we fit the data for each behavior with a GLMM using a Tweedie distribution. The data is not normal and shows over disperson making other distributions less suitable. The Tweedie distribution encompasses a wide range of distribution shapes and is also well suited for modeling continuous positive data inclusive of 0 values.</p>
<p>Each behavior has an emoji header to quickly find each chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">#️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       BODY ANCHOR STATS </span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co">#️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓⚓️⚓️⚓️⚓️️⚓⚓️️⚓️⚓️️⚓⚓️⚓️</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the BODY ANCHORING duration data</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>BodyAnchorTweedie <span class="ot">&lt;-</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Crinkle_Duration"</span>)</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>BodyAnchorTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> BodyAnchorTweedie,</span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> tweedie)</span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BodyAnchorTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: BodyAnchorTweedie

     AIC      BIC   logLik deviance df.resid 
   327.4    339.6   -157.7    315.4       51 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.144    0.3795  
Number of obs: 57, groups:  Eel, 8

Dispersion parameter for tweedie family (): 2.41 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       0.7342     0.3159   2.324  0.02014 *  
TreatmentMedium   1.0391     0.3560   2.919  0.00351 ** 
TreatmentSmall    1.3985     0.3568   3.920 8.86e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>BodyAnchorDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(BodyAnchorTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(BodyAnchorDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium   -1.039 0.356 Inf  -2.919  0.0098
 Large - Small    -1.399 0.357 Inf  -3.920  0.0003
 Medium - Small   -0.359 0.303 Inf  -1.188  0.4605

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(BodyAnchorDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Large      0.734 0.316 Inf     0.115      1.35  a    
 Medium     1.773 0.262 Inf     1.260      2.29   b   
 Small      2.133 0.265 Inf     1.613      2.65   b   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                       TAIL ANCHOR STATS </span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co">#️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓️⚓️⚓️⚓️⚓️️⚓⚓️⚓️⚓️⚓⚓⚓️⚓️⚓️⚓⚓️⚓️️⚓️⚓⚓️⚓️⚓️⚓️️</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the TAIL ANCHOR duration data</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>TailAnchorTweedie <span class="ot">&lt;-</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Anchor_Duration"</span>)</span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>TailAnchorTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> TailAnchorTweedie,</span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">family =</span> tweedie)</span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(TailAnchorTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: TailAnchorTweedie

     AIC      BIC   logLik deviance df.resid 
   268.7    280.9   -128.3    256.7       51 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.4522   0.6725  
Number of obs: 57, groups:  Eel, 8

Dispersion parameter for tweedie family (): 3.08 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)       0.5565     0.4401   1.265   0.2060  
TreatmentMedium   0.1075     0.4505   0.239   0.8114  
TreatmentSmall    0.9096     0.4174   2.179   0.0293 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>TailAnchorDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(TailAnchorTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(TailAnchorDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium   -0.107 0.450 Inf  -0.239  0.9691
 Large - Small    -0.910 0.417 Inf  -2.179  0.0748
 Medium - Small   -0.802 0.414 Inf  -1.936  0.1287

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(TailAnchorDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Large      0.557 0.440 Inf    -0.306      1.42  a    
 Medium     0.664 0.428 Inf    -0.174      1.50  a    
 Small      1.466 0.431 Inf     0.622      2.31  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                             ROTATING STATS</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫-😵‍💫</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the ROTATING duration data</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>RotatingTweedie <span class="ot">&lt;-</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Rotating_Duration"</span>)</span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>RotatingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">data =</span> RotatingTweedie,</span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">family =</span> tweedie)</span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RotatingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: RotatingTweedie

     AIC      BIC   logLik deviance df.resid 
   386.5    398.8   -187.3    374.5       51 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.09566  0.3093  
Number of obs: 57, groups:  Eel, 8

Dispersion parameter for tweedie family (): 2.99 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      2.17823    0.23995   9.078   &lt;2e-16 ***
TreatmentMedium  0.08949    0.29390   0.304    0.761    
TreatmentSmall  -0.13163    0.32419  -0.406    0.685    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>RotatingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(RotatingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(RotatingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium  -0.0895 0.294 Inf  -0.304  0.9502
 Large - Small    0.1316 0.324 Inf   0.406  0.9132
 Medium - Small   0.2211 0.328 Inf   0.673  0.7791

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(RotatingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Small       2.05 0.269 Inf      1.52      2.57  a    
 Large       2.18 0.240 Inf      1.71      2.65  a    
 Medium      2.27 0.242 Inf      1.79      2.74  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                                 RAMMING STATS</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏🐏</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the RAMMING duration data</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a>RammingTweedie <span class="ot">&lt;-</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Ramming_Duration"</span>)</span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>RammingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">data =</span> RammingTweedie,</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">family =</span> tweedie)</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RammingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: RammingTweedie

     AIC      BIC   logLik deviance df.resid 
    59.5     71.8    -23.8     47.5       51 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 6.352    2.52    
Number of obs: 57, groups:  Eel, 8

Dispersion parameter for tweedie family (): 8.23 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)       -37.67   34505.99  -0.001    0.999
TreatmentMedium    36.22   34505.99   0.001    0.999
TreatmentSmall     32.94   34505.99   0.001    0.999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>RammingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(RammingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(RammingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate       SE  df z.ratio p.value
 Large - Medium   -36.22 34505.99 Inf  -0.001  1.0000
 Large - Small    -32.94 34505.99 Inf  -0.001  1.0000
 Medium - Small     3.28     1.96 Inf   1.673  0.2158

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(RammingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean       SE  df asymp.LCL asymp.UCL .group
 Large     -37.67 34505.99 Inf -67668.16  67592.83  a    
 Small      -4.73     3.68 Inf    -11.94      2.48  a    
 Medium     -1.44     3.27 Inf     -7.85      4.97  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                              SHAKING STATS </span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝🤝</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Pulling out the SHAKING DURATION Data</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>ShakingTweedie <span class="ot">&lt;-</span> P2BehaviorDur_Long <span class="sc">%&gt;%</span> </span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Shaking_Duration"</span>)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a>ShakingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> ShakingTweedie,</span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">family =</span> tweedie)</span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ShakingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: ShakingTweedie

     AIC      BIC   logLik deviance df.resid 
   142.6    154.9    -65.3    130.6       51 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.2387   0.4886  
Number of obs: 57, groups:  Eel, 8

Dispersion parameter for tweedie family (): 0.798 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)      -0.5389     0.3122  -1.726   0.0843 .
TreatmentMedium  -0.2006     0.3642  -0.551   0.5817  
TreatmentSmall    0.1218     0.3559   0.342   0.7323  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated marginal means and pairwise comparisons </span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>ShakingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(ShakingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(ShakingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium    0.201 0.364 Inf   0.551  0.8460
 Large - Small    -0.122 0.356 Inf  -0.342  0.9375
 Medium - Small   -0.322 0.365 Inf  -0.882  0.6515

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(ShakingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Medium    -0.740 0.334 Inf     -1.39   -0.0858  a    
 Large     -0.539 0.312 Inf     -1.15    0.0729  a    
 Small     -0.417 0.322 Inf     -1.05    0.2131  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 3 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="graphics---duration-of-behaviors-1" class="level3">
<h3 class="anchored" data-anchor-id="graphics---duration-of-behaviors-1">Graphics - Duration of Behaviors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This graph shows the average DURATION spent in each behavior.</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 0's have been left in the data set </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the Future Facets:</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>Facet_Names_P2_BehaviorDur <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Knotting_Duration'</span> <span class="ot">=</span> <span class="st">"KNOTTING"</span>,</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Ramming_Duration'</span> <span class="ot">=</span> <span class="st">"RAMMING"</span>,</span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Rotating_Duration'</span> <span class="ot">=</span> <span class="st">"ROTATING"</span>,</span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Shaking_Duration'</span> <span class="ot">=</span> <span class="st">"SHAKING"</span>,</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Crinkle_Duration'</span> <span class="ot">=</span> <span class="st">"BODY ANCHOR"</span>,</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Anchor_Duration'</span> <span class="ot">=</span> <span class="st">"TAIL ANCHOR"</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>Facet_labeller_BehaviorDur2<span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Facet_Names_P2_BehaviorDur[value])}</span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a><span class="co">#Wrangling some pictures for the future</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Wrangling some pictures for the future</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>KnotPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Knotting.png"</span>) </span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>ShakePic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Shaking.png"</span>)</span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>RotatePic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Rotating.png"</span>)</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>RamPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Ramming.png"</span>)</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>BodyAnchorPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/bodyanchor.png"</span>)</span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a>TailAnchorPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/tailanchor.png"</span>)</span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-28"><a href="#cb181-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a data frame with pairwise significance </span></span>
<span id="cb181-29"><a href="#cb181-29" aria-hidden="true" tabindex="-1"></a>P2_signif <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb181-30"><a href="#cb181-30" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Treatment, <span class="sc">~</span>Behavior,          <span class="sc">~</span>Signif,</span>
<span id="cb181-31"><a href="#cb181-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Anchor_Duration"</span>, <span class="st">"b"</span>,    </span>
<span id="cb181-32"><a href="#cb181-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Anchor_Duration"</span>, <span class="st">"b"</span>,   </span>
<span id="cb181-33"><a href="#cb181-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Anchor_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-34"><a href="#cb181-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Crinkle_Duration"</span>, <span class="st">"b"</span>,    </span>
<span id="cb181-35"><a href="#cb181-35" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Crinkle_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb181-36"><a href="#cb181-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Crinkle_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-37"><a href="#cb181-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Knotting_Duration"</span>, <span class="st">"***"</span>,    </span>
<span id="cb181-38"><a href="#cb181-38" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Knotting_Duration"</span>, <span class="st">""</span>,   </span>
<span id="cb181-39"><a href="#cb181-39" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Knotting_Duration"</span>, <span class="st">""</span>,    </span>
<span id="cb181-40"><a href="#cb181-40" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Ramming_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-41"><a href="#cb181-41" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Ramming_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb181-42"><a href="#cb181-42" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Ramming_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb181-43"><a href="#cb181-43" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-44"><a href="#cb181-44" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb181-45"><a href="#cb181-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-46"><a href="#cb181-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Shaking_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb181-47"><a href="#cb181-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Shaking_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb181-48"><a href="#cb181-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Shaking_Duration"</span>, <span class="st">"a"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb181-49"><a href="#cb181-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">transmute</span>(P2BehaviorDurSE, Treatment, Behavior, mean, se),</span>
<span id="cb181-50"><a href="#cb181-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Behavior"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb181-51"><a href="#cb181-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>),</span>
<span id="cb181-52"><a href="#cb181-52" aria-hidden="true" tabindex="-1"></a>         <span class="at">Behavior =</span> <span class="fu">factor</span>(Behavior),</span>
<span id="cb181-53"><a href="#cb181-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> mean <span class="sc">+</span> se <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb181-54"><a href="#cb181-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-55"><a href="#cb181-55" aria-hidden="true" tabindex="-1"></a><span class="co"># The graph:</span></span>
<span id="cb181-56"><a href="#cb181-56" aria-hidden="true" tabindex="-1"></a>P2_BehaviorDur <span class="ot">=</span> P2BehaviorDurSE <span class="sc">%&gt;%</span> </span>
<span id="cb181-57"><a href="#cb181-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb181-58"><a href="#cb181-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb181-59"><a href="#cb181-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb181-60"><a href="#cb181-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb181-61"><a href="#cb181-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb181-62"><a href="#cb181-62" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Adding error bars: </span></span>
<span id="cb181-63"><a href="#cb181-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb181-64"><a href="#cb181-64" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb181-65"><a href="#cb181-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ADD SIGNIFICANCE TEXT</span></span>
<span id="cb181-66"><a href="#cb181-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> Signif), P2_signif, <span class="at">size=</span><span class="dv">6</span>, <span class="at">face=</span><span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb181-67"><a href="#cb181-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">#All other aesthetics:</span></span>
<span id="cb181-68"><a href="#cb181-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>, <span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>)) <span class="sc">+</span></span>
<span id="cb181-69"><a href="#cb181-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>))<span class="sc">+</span></span>
<span id="cb181-70"><a href="#cb181-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb181-71"><a href="#cb181-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Average Duration (Sec)"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb181-72"><a href="#cb181-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Behavior, <span class="at">labeller =</span> Facet_labeller_BehaviorDur2) <span class="sc">+</span></span>
<span id="cb181-73"><a href="#cb181-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb181-74"><a href="#cb181-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb181-75"><a href="#cb181-75" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb181-76"><a href="#cb181-76" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb181-77"><a href="#cb181-77" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb181-78"><a href="#cb181-78" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb181-79"><a href="#cb181-79" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb181-80"><a href="#cb181-80" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb181-81"><a href="#cb181-81" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb181-82"><a href="#cb181-82" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb181-83"><a href="#cb181-83" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_text(aes(y = y, label = Signif), P2_signif, size = 6, face =
"bold"): Ignoring unknown parameters: `face`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `labeller` API has been updated. Labellers taking `variable` and `value`
arguments are now deprecated.
ℹ See labellers documentation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>P2_BehaviorDur</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/PHASE%202-%20Graphics%20-%20Average%20Durations%20of%20Behaviors%20(Not%20Proportion)%20-%20All%20data-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>P2_BehaviorDur_Pics <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>(P2_BehaviorDur) <span class="sc">+</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(TailAnchorPic, <span class="at">x=</span><span class="fl">0.31</span> , <span class="at">y=</span><span class="fl">0.92</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">19</span>, width</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">19</span>) <span class="sc">+</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(BodyAnchorPic, <span class="at">x=</span><span class="fl">0.62</span> , <span class="at">y=</span><span class="fl">0.94</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">17</span>, width</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(KnotPic, <span class="at">x=</span><span class="fl">0.95</span> , <span class="at">y=</span><span class="fl">0.9</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">2</span>, width</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">2</span> ) <span class="sc">+</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(RamPic, <span class="at">x=</span><span class="fl">0.29</span> , <span class="at">y=</span><span class="fl">0.45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">17</span>, width</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">17</span>) <span class="sc">+</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(RotatePic, <span class="at">x=</span><span class="fl">0.659</span> , <span class="at">y=</span><span class="fl">0.54</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">23</span>, width</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">23</span> ) <span class="sc">+</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(ShakePic, <span class="at">x=</span><span class="fl">0.95</span> , <span class="at">y=</span><span class="fl">0.45</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">2</span>, width</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">2</span> )</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>P2_BehaviorDur_Pics </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/PHASE%202-%20Graphics%20-%20Average%20Durations%20of%20Behaviors%20(Not%20Proportion)%20-%20All%20data-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Saves to Reports folder within the project folder</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P2-Behavior Durations.png"</span>, <span class="at">plot =</span> P2_BehaviorDur_Pics , <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">7</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section-2" class="level1">
<h1>—————————-</h1>
<section id="experiment-2---final-figure" class="level2">
<h2 class="anchored" data-anchor-id="experiment-2---final-figure">Experiment 2 - FINAL FIGURE</h2>
</section>
</section>
<section id="section-3" class="level1">
<h1>—————————</h1>
<p>The code below combines the Trial Component Figure with the Behavior Duration Figure for Experiment 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>P2_FinalFigure <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(P2_Dur_Graph, P2_BehaviorDur_Pics,</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>,</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">heights =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>))</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>P2_FinalFigure</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/Final%20Figure-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"P2_Final.png"</span>, <span class="at">plot =</span> P2_FinalFigure, <span class="at">width =</span> <span class="dv">11</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>#~~~~~~~~~~~~~~~~~~~~ # BONUS FEATURES #~~~~~~~~~~~~~~~~~~~~</p>
<section id="experiment-1-2-combined" class="level2">
<h2 class="anchored" data-anchor-id="experiment-1-2-combined">Experiment 1 &amp; 2 Combined</h2>
<p>The following code combines data from experiments 1 and 2. We wanted to compare the durations spent engaged in different behaviors between the open treatment (experiment 1) and all three diameter-based treatments from experiment 2 (small, medium, large)</p>
<section id="data-prep---bonus" class="level3">
<h3 class="anchored" data-anchor-id="data-prep---bonus">Data Prep - Bonus</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading in the dataset</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>Bonus <span class="ot">=</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Phase2-SpatialContext+Open.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 102 Columns: 30
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (3): Eel, Treatment, Knotting_Binomial
dbl (27): Treatment_Round, Trial_Duration, Handling_Duration, PT_Duration, P...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Bonus) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 30
  Eel     Treatment Treatment_Round Trial_Duration Handling_Duration PT_Duration
  &lt;chr&gt;   &lt;chr&gt;               &lt;dbl&gt;          &lt;dbl&gt;             &lt;dbl&gt;       &lt;dbl&gt;
1 Eelvis  Small                   1           50.4              49.3        1.17
2 Snicke… Small                   1           NA                NA         NA   
3 Bill    Small                   1           27.4              19.4        7.99
4 Hamlet  Small                   1           38.2              24.8       13.3 
5 Horatio Small                   1           30.4              17.9       12.5 
6 Spaghe… Small                   1           45.9              42.9        3.01
# ℹ 24 more variables: PT_Prop &lt;dbl&gt;, Knotting_Duration &lt;dbl&gt;,
#   Knotting_Prop &lt;dbl&gt;, Knotting_Prop_Handling &lt;dbl&gt;, Knotting_Binomial &lt;chr&gt;,
#   Rotating_Duration &lt;dbl&gt;, Rotating_Prop &lt;dbl&gt;, Rotating_Prop_Handling &lt;dbl&gt;,
#   Ramming_Duration &lt;dbl&gt;, Ramming_Prop &lt;dbl&gt;, Ramming_Prop_Handling &lt;dbl&gt;,
#   Shaking_Duration &lt;dbl&gt;, Shaking_Prop &lt;dbl&gt;, Shaking_Prop_Handling &lt;dbl&gt;,
#   Crinkle_Duration &lt;dbl&gt;, Crinkle_Prop &lt;dbl&gt;, Crinkle_Prop_Handling &lt;dbl&gt;,
#   Tug_Duration &lt;dbl&gt;, Tug_Prop &lt;dbl&gt;, Tug_Prop_Handling &lt;dbl&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Selecting the columns we want:</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>BonusSel <span class="ot">&lt;-</span> Bonus <span class="sc">%&gt;%</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Treatment, Eel, Ramming_Duration, Shaking_Duration, Rotating_Duration, Knotting_Duration) <span class="sc">%&gt;%</span></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BonusSel) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Treatment Eel        Ramming_Duration Shaking_Duration Rotating_Duration
  &lt;chr&gt;     &lt;chr&gt;                 &lt;dbl&gt;            &lt;dbl&gt;             &lt;dbl&gt;
1 Small     Eelvis                    0            0                14.1  
2 Small     Bill                      0            0.504             0.973
3 Small     Hamlet                    0            0.403             6.14 
4 Small     Horatio                   0            0                 0    
5 Small     Spaghettio                0            0                13.5  
6 Small     Jhonny                    0            0                 6.85 
# ℹ 1 more variable: Knotting_Duration &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making stuff a factor:</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>BonusSel<span class="sc">$</span>Treatment <span class="ot">=</span> <span class="fu">factor</span>(BonusSel<span class="sc">$</span>Treatment)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>BonusSel<span class="sc">$</span>Eel <span class="ot">=</span> <span class="fu">factor</span>(BonusSel<span class="sc">$</span>Eel)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>Bonus_Long <span class="ot">&lt;-</span> BonusSel <span class="sc">%&gt;%</span></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Shaking_Duration, Ramming_Duration, Knotting_Duration, Rotating_Duration), </span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Behavior"</span>, </span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Duration"</span>)</span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Bonus_Long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  Treatment Eel    Behavior          Duration
  &lt;fct&gt;     &lt;fct&gt;  &lt;chr&gt;                &lt;dbl&gt;
1 Small     Eelvis Shaking_Duration     0    
2 Small     Eelvis Ramming_Duration     0    
3 Small     Eelvis Knotting_Duration    0    
4 Small     Eelvis Rotating_Duration   14.1  
5 Small     Bill   Shaking_Duration     0.504
6 Small     Bill   Ramming_Duration     0    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Mean &amp; SE </span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>BonusSE <span class="ot">=</span> Bonus_Long <span class="sc">%&gt;%</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment, Behavior) <span class="sc">%&gt;%</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'Treatment'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BonusSE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   Treatment [2]
  Treatment Behavior           mean    sd     n    se
  &lt;fct&gt;     &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;
1 Large     Knotting_Duration 2.91  4.63     20 1.03 
2 Large     Ramming_Duration  0     0        20 0    
3 Large     Rotating_Duration 9.10  9.37     20 2.10 
4 Large     Shaking_Duration  0.666 0.974    20 0.218
5 Medium    Knotting_Duration 0     0        20 0    
6 Medium    Ramming_Duration  1.76  5.73     20 1.28 </code></pre>
</div>
</div>
</section>
<section id="bonus-stats" class="level3">
<h3 class="anchored" data-anchor-id="bonus-stats">Bonus Stats</h3>
<p>The following code compares the durations spent engaged in shaking, ramming, rotating, and knotting between the open and diameter based treatments (small, medium, large)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="do">## SHAKING DURATION</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>BonusShaking <span class="ot">&lt;-</span> Bonus_Long <span class="sc">%&gt;%</span> </span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Shaking_Duration"</span>) </span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-8"><a href="#cb201-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-9"><a href="#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model using glmmTMB</span></span>
<span id="cb201-10"><a href="#cb201-10" aria-hidden="true" tabindex="-1"></a>BonusShakingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb201-11"><a href="#cb201-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> BonusShaking,</span>
<span id="cb201-12"><a href="#cb201-12" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> tweedie)</span>
<span id="cb201-13"><a href="#cb201-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-14"><a href="#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb201-15"><a href="#cb201-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BonusShakingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: BonusShaking

     AIC      BIC   logLik deviance df.resid 
   216.7    234.6   -101.3    202.7       89 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.3039   0.5512  
Number of obs: 96, groups:  Eel, 10

Dispersion parameter for tweedie family (): 0.844 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)      -0.5712     0.3241  -1.762    0.078 .
TreatmentMedium  -0.1975     0.3682  -0.536    0.592  
TreatmentOpen    -0.4890     0.3402  -1.438    0.151  
TreatmentSmall    0.2105     0.3768   0.559    0.576  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>BonusShakingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(BonusShakingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(BonusShakingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium    0.198 0.368 Inf   0.536  0.9502
 Large - Open      0.489 0.340 Inf   1.438  0.4758
 Large - Small    -0.211 0.377 Inf  -0.559  0.9442
 Medium - Open     0.291 0.357 Inf   0.817  0.8467
 Medium - Small   -0.408 0.386 Inf  -1.057  0.7156
 Open - Small     -0.700 0.367 Inf  -1.905  0.2259

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(BonusShakingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Open      -1.060 0.291 Inf     -1.63   -0.4888  a    
 Medium    -0.769 0.342 Inf     -1.44   -0.0991  a    
 Large     -0.571 0.324 Inf     -1.21    0.0640  a    
 Small     -0.361 0.339 Inf     -1.03    0.3041  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="do">## RAMMING DURATION</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>BonusRamming <span class="ot">&lt;-</span> Bonus_Long  <span class="sc">%&gt;%</span> </span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Ramming_Duration"</span>)</span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-8"><a href="#cb207-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-9"><a href="#cb207-9" aria-hidden="true" tabindex="-1"></a>BonusRammingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb207-10"><a href="#cb207-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> BonusRamming,</span>
<span id="cb207-11"><a href="#cb207-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> tweedie)</span>
<span id="cb207-12"><a href="#cb207-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-13"><a href="#cb207-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb207-14"><a href="#cb207-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BonusRammingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: BonusRamming

     AIC      BIC   logLik deviance df.resid 
   121.7    139.7    -53.9    107.7       89 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 7.929    2.816   
Number of obs: 96, groups:  Eel, 10

Dispersion parameter for tweedie family (): 5.93 

Conditional model:
                Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)       -34.01   21206.20  -0.002    0.999
TreatmentMedium    31.56   21206.19   0.001    0.999
TreatmentOpen      32.09   21206.19   0.002    0.999
TreatmentSmall     28.39   21206.19   0.001    0.999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>BonusRammingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(BonusRammingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(BonusRammingDurEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate       SE  df z.ratio p.value
 Large - Medium  -31.558 21206.19 Inf  -0.001  1.0000
 Large - Open    -32.089 21206.19 Inf  -0.002  1.0000
 Large - Small   -28.387 21206.19 Inf  -0.001  1.0000
 Medium - Open    -0.531     0.96 Inf  -0.553  0.9457
 Medium - Small    3.171     1.81 Inf   1.754  0.2958
 Open - Small      3.702     1.98 Inf   1.874  0.2392

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(BonusRammingDurEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean       SE  df asymp.LCL asymp.UCL .group
 Large     -34.01 21206.19 Inf -41597.38  41529.37  a    
 Small      -5.62     2.62 Inf    -10.75     -0.49  a    
 Medium     -2.45     1.95 Inf     -6.28      1.38  a    
 Open       -1.92     1.64 Inf     -5.12      1.29  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ROTATING DURATION</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>BonusRotating <span class="ot">&lt;-</span>  Bonus_Long   <span class="sc">%&gt;%</span> </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Rotating_Duration"</span>)</span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>BonusRotatingTweedie_Model  <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> BonusRotating,</span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> tweedie)</span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BonusRotatingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: BonusRotating

     AIC      BIC   logLik deviance df.resid 
   491.2    509.2   -238.6    477.2       89 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 0.1793   0.4235  
Number of obs: 96, groups:  Eel, 10

Dispersion parameter for tweedie family ():  2.3 

Conditional model:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)      2.149971   0.242377   8.870  &lt; 2e-16 ***
TreatmentMedium  0.056451   0.265611   0.213    0.832    
TreatmentOpen   -2.655312   0.335428  -7.916 2.45e-15 ***
TreatmentSmall   0.002388   0.294306   0.008    0.994    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>Bonus_RotatingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(BonusRotatingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Bonus_RotatingDurEMMS )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate    SE  df z.ratio p.value
 Large - Medium -0.05645 0.266 Inf  -0.213  0.9966
 Large - Open    2.65531 0.335 Inf   7.916  &lt;.0001
 Large - Small  -0.00239 0.294 Inf  -0.008  1.0000
 Medium - Open   2.71176 0.334 Inf   8.121  &lt;.0001
 Medium - Small  0.05406 0.300 Inf   0.180  0.9979
 Open - Small   -2.65770 0.364 Inf  -7.293  &lt;.0001

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(Bonus_RotatingDurEMMS , <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment emmean    SE  df asymp.LCL asymp.UCL .group
 Open      -0.505 0.308 Inf     -1.11    0.0974  a    
 Large      2.150 0.242 Inf      1.67    2.6250   b   
 Small      2.152 0.272 Inf      1.62    2.6850   b   
 Medium     2.206 0.246 Inf      1.72    2.6895   b   

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="do">## KNOTTING DURATION </span></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="do">####################</span></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>Bonus_Knotting <span class="ot">&lt;-</span> Bonus_Long <span class="sc">%&gt;%</span> </span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Behavior <span class="sc">==</span> <span class="st">"Knotting_Duration"</span>)</span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with repeated measures</span></span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>BonusKnottingTweedie_Model <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(Duration <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">data =</span> Bonus_Knotting,</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">family =</span> tweedie)</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(BonusKnottingTweedie_Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          Duration ~ Treatment + (1 | Eel)
Data: Bonus_Knotting

     AIC      BIC   logLik deviance df.resid 
   227.3    245.3   -106.7    213.3       89 

Random effects:

Conditional model:
 Groups Name        Variance Std.Dev.
 Eel    (Intercept) 1.795    1.34    
Number of obs: 96, groups:  Eel, 10

Dispersion parameter for tweedie family (): 5.84 

Conditional model:
                  Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)      9.464e-02  6.637e-01   0.143    0.887
TreatmentMedium -2.996e+01  1.759e+04  -0.002    0.999
TreatmentOpen    5.886e-01  4.870e-01   1.209    0.227
TreatmentSmall  -3.103e+01  3.173e+04  -0.001    0.999</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>Bonus_KnottingDurEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(BonusKnottingTweedie_Model, <span class="st">"Treatment"</span>)</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(Bonus_KnottingDurEMMS )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate       SE  df z.ratio p.value
 Large - Medium   29.959 17587.11 Inf   0.002  1.0000
 Large - Open     -0.589     0.49 Inf  -1.209  0.6213
 Large - Small    31.030 31731.35 Inf   0.001  1.0000
 Medium - Open   -30.548 17587.11 Inf  -0.002  1.0000
 Medium - Small    1.071 36279.26 Inf   0.000  1.0000
 Open - Small     31.619 31731.35 Inf   0.001  1.0000

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(Bonus_KnottingDurEMMS , <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment   emmean       SE  df asymp.LCL asymp.UCL .group
 Small     -30.9356 31731.35 Inf -62223.24   62161.4  a    
 Medium    -29.8644 17587.11 Inf -34499.96   34440.2  a    
 Large       0.0946     0.66 Inf     -1.21       1.4  a    
 Open        0.6833     0.57 Inf     -0.43       1.8  a    

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="bonus-graphics" class="level3">
<h3 class="anchored" data-anchor-id="bonus-graphics">Bonus Graphics</h3>
<p>The following code graphs the behaviors that showed interesting results (knotting and rotating)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>BonusGraphData <span class="ot">&lt;-</span> BonusSE <span class="sc">%&gt;%</span> </span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">filter</span>(Behavior <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Knotting_Duration"</span>, <span class="st">"Rotating_Duration"</span>))</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a data frame with pairwise significance </span></span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>Bonus_signif <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Treatment, <span class="sc">~</span>Behavior,          <span class="sc">~</span>Signif,</span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,     <span class="st">"Knotting_Duration"</span>, <span class="st">"a"</span>,</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Knotting_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Knotting_Duration"</span>,  <span class="st">""</span>, </span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Knotting_Duration"</span>,  <span class="st">""</span>,</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,     <span class="st">"Rotating_Duration"</span>, <span class="st">"b"</span>,</span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,    <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span>,    </span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,   <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span>,   </span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,    <span class="st">"Rotating_Duration"</span>, <span class="st">"a"</span></span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">transmute</span>(BonusGraphData, Treatment, Behavior, mean, se),</span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>, <span class="st">"Behavior"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb225-18"><a href="#cb225-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>),</span>
<span id="cb225-19"><a href="#cb225-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Behavior =</span> <span class="fu">factor</span>(Behavior),</span>
<span id="cb225-20"><a href="#cb225-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> mean <span class="sc">+</span> se <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb225-21"><a href="#cb225-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-22"><a href="#cb225-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-23"><a href="#cb225-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the Future Facets:</span></span>
<span id="cb225-24"><a href="#cb225-24" aria-hidden="true" tabindex="-1"></a>Facet_Names_Bonus <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb225-25"><a href="#cb225-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Knotting_Duration'</span> <span class="ot">=</span> <span class="st">"KNOTTING"</span>,</span>
<span id="cb225-26"><a href="#cb225-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Rotating_Duration'</span> <span class="ot">=</span> <span class="st">"ROTATING"</span></span>
<span id="cb225-27"><a href="#cb225-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb225-28"><a href="#cb225-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-29"><a href="#cb225-29" aria-hidden="true" tabindex="-1"></a>Facet_labeller_Bonus <span class="ot">&lt;-</span> <span class="cf">function</span>(variable,value){</span>
<span id="cb225-30"><a href="#cb225-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Facet_Names_Bonus[value])}</span>
<span id="cb225-31"><a href="#cb225-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-32"><a href="#cb225-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-33"><a href="#cb225-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Wrangling some pictures for the future</span></span>
<span id="cb225-34"><a href="#cb225-34" aria-hidden="true" tabindex="-1"></a>KnotPic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Knotting.png"</span>) </span>
<span id="cb225-35"><a href="#cb225-35" aria-hidden="true" tabindex="-1"></a>RotatePic <span class="ot">=</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"/Users/mayamcelfish/Desktop/ArrRrrr/SpatialContext_PreyManipulation/images/Rotating.png"</span>)</span>
<span id="cb225-36"><a href="#cb225-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-37"><a href="#cb225-37" aria-hidden="true" tabindex="-1"></a><span class="co"># The graph:</span></span>
<span id="cb225-38"><a href="#cb225-38" aria-hidden="true" tabindex="-1"></a>BonusGraph <span class="ot">=</span> BonusGraphData <span class="sc">%&gt;%</span> </span>
<span id="cb225-39"><a href="#cb225-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb225-40"><a href="#cb225-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb225-41"><a href="#cb225-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb225-42"><a href="#cb225-42" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb225-43"><a href="#cb225-43" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb225-44"><a href="#cb225-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Adding error bars: </span></span>
<span id="cb225-45"><a href="#cb225-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb225-46"><a href="#cb225-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">5</span>) <span class="sc">+</span> </span>
<span id="cb225-47"><a href="#cb225-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ADD SIGNIFICANCE TEXT</span></span>
<span id="cb225-48"><a href="#cb225-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> Signif), Bonus_signif, <span class="at">size=</span><span class="dv">6</span>, <span class="at">face=</span><span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb225-49"><a href="#cb225-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#All other aesthetics:</span></span>
<span id="cb225-50"><a href="#cb225-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>, <span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>, <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb225-51"><a href="#cb225-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>))<span class="sc">+</span></span>
<span id="cb225-52"><a href="#cb225-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">25</span>)<span class="sc">+</span></span>
<span id="cb225-53"><a href="#cb225-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Average Duration (Sec)"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>) <span class="sc">+</span></span>
<span id="cb225-54"><a href="#cb225-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> Behavior, <span class="at">labeller =</span> Facet_labeller_Bonus) <span class="sc">+</span></span>
<span id="cb225-55"><a href="#cb225-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb225-56"><a href="#cb225-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb225-57"><a href="#cb225-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb225-58"><a href="#cb225-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb225-59"><a href="#cb225-59" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb225-60"><a href="#cb225-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb225-61"><a href="#cb225-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb225-62"><a href="#cb225-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb225-63"><a href="#cb225-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb225-64"><a href="#cb225-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb225-65"><a href="#cb225-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_text(aes(y = y, label = Signif), Bonus_signif, size = 6, :
Ignoring unknown parameters: `face`</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `labeller` API has been updated. Labellers taking `variable` and `value`
arguments are now deprecated.
ℹ See labellers documentation.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>BonusGraph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/Bonus%20Graphics-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>Bonus_Pics <span class="ot">&lt;-</span> <span class="fu">ggdraw</span>(BonusGraph) <span class="sc">+</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(KnotPic, <span class="at">x=</span><span class="fl">0.4</span> , <span class="at">y=</span><span class="fl">0.86</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">25</span>, width</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">25</span> ) <span class="sc">+</span></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="fu">draw_image</span>(RotatePic, <span class="at">x=</span><span class="fl">0.93</span> , <span class="at">y=</span><span class="fl">0.9</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span><span class="dv">1</span>, <span class="at">height =</span> .<span class="dv">3</span>, width</span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span>.<span class="dv">3</span> ) </span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a>Bonus_Pics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/Bonus%20Graphics-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This saves to the reports folder within the project</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"BonusGraphic.png"</span>, <span class="at">plot =</span> Bonus_Pics , <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="section-4" class="level1">
<h1>🏎💨 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 🏎💨</h1>
</section>
<section id="rotation-speed" class="level1">
<h1>ROTATION SPEED</h1>
</section>
<section id="section-5" class="level1">
<h1>🏎💨 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ 🏎💨</h1>
<section id="rotation-data-set-up" class="level3">
<h3 class="anchored" data-anchor-id="rotation-data-set-up">Rotation Data Set-Up</h3>
<p>The following code reads in the data set for rotating speed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading in the dataset</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>Rot<span class="ot">=</span><span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Rotation_Complete.csv"</span>))</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Rot) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Treatment Treatment_Exposure    Eel Rotation_Bout Rotation_Duration
1     Small                  1 Hamlet             1             3.250
2     Small                  1 Hamlet             2             1.739
3     Small                  1 Hamlet             3             2.239
4     Small                  2 Hamlet             1             1.688
5     Small                  2 Hamlet             2             1.003
6     Small                  2 Hamlet             3             1.502
  Opercular_Passes Opercular_Passes.2 Rotation_Second Notes
1                2                1.0       0.3076923    NA
2                3                1.5       0.8625647    NA
3                3                1.5       0.6699419    NA
4                2                1.0       0.5924171    NA
5                2                1.0       0.9970090    NA
6                3                1.5       0.9986684    NA</code></pre>
</div>
</div>
<p>The followig code calculated the mean and standard error for rotating speed</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Making things factors:</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>Rot <span class="sc">$</span> Treatment <span class="ot">=</span> <span class="fu">factor</span>(Rot <span class="sc">$</span> Treatment)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>Rot <span class="sc">$</span> Eel <span class="ot">=</span> <span class="fu">factor</span>(Rot <span class="sc">$</span> Eel)</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Mean &amp; SE </span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>Rot_SE <span class="ot">=</span> Rot <span class="sc">%&gt;%</span></span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Treatment) <span class="sc">%&gt;%</span></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(Rotation_Second, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd =</span> <span class="fu">sd</span>(Rotation_Second, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">se =</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>Rot_SE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  Treatment  mean    sd     n     se
  &lt;fct&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
1 Large     1.02  0.531    62 0.0674
2 Medium    0.679 0.365    58 0.0479
3 Open      1.42  0.434    51 0.0607
4 Small     0.692 0.350    58 0.0460</code></pre>
</div>
</div>
</section>
<section id="rotation-speed-stats" class="level3">
<h3 class="anchored" data-anchor-id="rotation-speed-stats">Rotation Speed Stats</h3>
<p>To compare rotation speed between treatments, we log-transformed the data and employed a mixed-effects model with a gamma distribution. We incorporated individual eels as a repeated measure by including eel identity as a random effect to account for variability between individuals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Rot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Treatment Treatment_Exposure    Eel Rotation_Bout Rotation_Duration
1     Small                  1 Hamlet             1             3.250
2     Small                  1 Hamlet             2             1.739
3     Small                  1 Hamlet             3             2.239
4     Small                  2 Hamlet             1             1.688
5     Small                  2 Hamlet             2             1.003
6     Small                  2 Hamlet             3             1.502
  Opercular_Passes Opercular_Passes.2 Rotation_Second Notes
1                2                1.0       0.3076923    NA
2                3                1.5       0.8625647    NA
3                3                1.5       0.6699419    NA
4                2                1.0       0.5924171    NA
5                2                1.0       0.9970090    NA
6                3                1.5       0.9986684    NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-transform the Rotation_Duration variable</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>Rot <span class="ot">&lt;-</span> Rot <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Log_Rotation_Second=</span> <span class="fu">log</span>(Rotation_Second <span class="sc">+</span> <span class="dv">1</span>))  <span class="co"># Adding 1 to avoid log(0)</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gamma GLMM with repeated measures, adjusting optimization settings</span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>RotGamma <span class="ot">&lt;-</span> <span class="fu">glmer</span>(Rotation_Second <span class="sc">~</span> Treatment <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Eel),</span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> Rot,</span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print model summary</span></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RotGamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: Gamma  ( log )
Formula: Rotation_Second ~ Treatment + (1 | Eel)
   Data: Rot

     AIC      BIC   logLik deviance df.resid 
   188.7    208.4    -88.3    176.7      191 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.8269 -0.6360 -0.1224  0.4818  4.3449 

Random effects:
 Groups   Name        Variance Std.Dev.
 Eel      (Intercept) 0.01339  0.1157  
 Residual             0.22742  0.4769  
Number of obs: 197, groups:  Eel, 10

Fixed effects:
                 Estimate Std. Error t value Pr(&gt;|z|)    
(Intercept)     -0.004247   0.091480  -0.046    0.963    
TreatmentMedium -0.383990   0.089072  -4.311 1.63e-05 ***
TreatmentOpen    0.428373   0.110089   3.891 9.98e-05 ***
TreatmentSmall  -0.375937   0.095189  -3.949 7.84e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) TrtmnM TrtmnO
TreatmntMdm -0.496              
TreatmntOpn -0.440  0.414       
TretmntSmll -0.482  0.482  0.406</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>RotEMMS <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(RotGamma, <span class="st">"Treatment"</span>)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(RotEMMS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> contrast       estimate     SE  df z.ratio p.value
 Large - Medium  0.38399 0.0891 Inf   4.311  0.0001
 Large - Open   -0.42837 0.1101 Inf  -3.891  0.0006
 Large - Small   0.37594 0.0952 Inf   3.949  0.0005
 Medium - Open  -0.81236 0.1093 Inf  -7.434  &lt;.0001
 Medium - Small -0.00805 0.0940 Inf  -0.086  0.9998
 Open - Small    0.80431 0.1125 Inf   7.148  &lt;.0001

Results are given on the log (not the response) scale. 
P value adjustment: tukey method for comparing a family of 4 estimates </code></pre>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">:::</span><span class="fu">cld.emmGrid</span>(RotEMMS, <span class="at">Letters =</span> letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Treatment   emmean     SE  df asymp.LCL asymp.UCL .group
 Medium    -0.38824 0.0906 Inf    -0.566    -0.211  a    
 Small     -0.38018 0.0950 Inf    -0.566    -0.194  a    
 Large     -0.00425 0.0915 Inf    -0.184     0.175   b   
 Open       0.42413 0.1079 Inf     0.213     0.636    c  

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="graphics---rotation-speeds" class="level3">
<h3 class="anchored" data-anchor-id="graphics---rotation-speeds">Graphics - Rotation Speeds</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Telling the bars to go from Small to Medium to Large instead of alphabetical </span></span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>Rot_SE<span class="sc">$</span>Treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(Rot_SE<span class="sc">$</span>Treatment, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>,<span class="st">"Open"</span>))</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: create a data frame with pairwise significance </span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a dummy, adjust once you have the actual results</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>Rot_signif <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Treatment,   <span class="sc">~</span>Signif,</span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Open"</span>,      <span class="st">"c"</span>,</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Large"</span>,     <span class="st">"b"</span>,    </span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Medium"</span>,    <span class="st">"a"</span>,   </span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Small"</span>,     <span class="st">"a"</span>,    </span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a> ) <span class="sc">%&gt;%</span> </span>
<span id="cb243-14"><a href="#cb243-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">transmute</span>(Rot_SE, Treatment, mean, se),</span>
<span id="cb243-15"><a href="#cb243-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Treatment"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb243-16"><a href="#cb243-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>),</span>
<span id="cb243-17"><a href="#cb243-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> mean <span class="sc">+</span> se <span class="sc">+</span> .<span class="dv">15</span>)</span>
<span id="cb243-18"><a href="#cb243-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-19"><a href="#cb243-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-20"><a href="#cb243-20" aria-hidden="true" tabindex="-1"></a>Rot_Graph <span class="ot">=</span> Rot_SE <span class="sc">%&gt;%</span> </span>
<span id="cb243-21"><a href="#cb243-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Treatment =</span> <span class="fu">fct_relevel</span>(Treatment, <span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb243-22"><a href="#cb243-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Treatment, mean, <span class="at">fill =</span> Treatment)) <span class="sc">+</span> </span>
<span id="cb243-23"><a href="#cb243-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span><span class="st">"identity"</span>, </span>
<span id="cb243-24"><a href="#cb243-24" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"black"</span>, </span>
<span id="cb243-25"><a href="#cb243-25" aria-hidden="true" tabindex="-1"></a>           <span class="at">width =</span> <span class="fl">0.7</span>,</span>
<span id="cb243-26"><a href="#cb243-26" aria-hidden="true" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb243-27"><a href="#cb243-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># error bar </span></span>
<span id="cb243-28"><a href="#cb243-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean <span class="sc">-</span> se, <span class="at">ymax =</span> mean <span class="sc">+</span> se), </span>
<span id="cb243-29"><a href="#cb243-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">width =</span> .<span class="dv">25</span>) <span class="sc">+</span> </span>
<span id="cb243-30"><a href="#cb243-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># STEP 2: ADD SIGNIFICANCE TEXT</span></span>
<span id="cb243-31"><a href="#cb243-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">label =</span> Signif), Rot_signif, <span class="at">size=</span><span class="dv">6</span>, <span class="at">face=</span><span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb243-32"><a href="#cb243-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkslategray4"</span>,<span class="st">"darkslategray3"</span>, <span class="st">"azure2"</span>, <span class="st">"white"</span>)) <span class="sc">+</span></span>
<span id="cb243-33"><a href="#cb243-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Small"</span>,<span class="st">"Medium"</span>, <span class="st">"Large"</span>, <span class="st">"Open"</span>))<span class="sc">+</span></span>
<span id="cb243-34"><a href="#cb243-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Mean Rotation Speed (Rotations/Sec)"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>, <span class="at">title =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb243-35"><a href="#cb243-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet wrap + the label code from above for our new label names</span></span>
<span id="cb243-36"><a href="#cb243-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb243-37"><a href="#cb243-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span> (<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb243-38"><a href="#cb243-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span>  <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb243-39"><a href="#cb243-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>, <span class="at">r =</span> <span class="dv">20</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>)),</span>
<span id="cb243-40"><a href="#cb243-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb243-41"><a href="#cb243-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb243-42"><a href="#cb243-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.spacing.x =</span> <span class="fu">unit</span>(<span class="dv">2</span>, <span class="st">"lines"</span>),</span>
<span id="cb243-43"><a href="#cb243-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span>.<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">40</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb243-44"><a href="#cb243-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"ivory3"</span>),</span>
<span id="cb243-45"><a href="#cb243-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.placement =</span> <span class="st">"inside"</span>,</span>
<span id="cb243-46"><a href="#cb243-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_text(aes(y = y, label = Signif), Rot_signif, size = 6, face =
"bold"): Ignoring unknown parameters: `face`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>Rot_Graph </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="SpatialContext_Code_files/figure-html/Rotation%20Graphics-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The graph saves to the Reports folder witn in the project folder</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"Rotation Speed.png"</span>, <span class="at">plot =</span> Rot_Graph, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>